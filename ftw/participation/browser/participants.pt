<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="here/main_template/macros/master"

      i18n:domain="ftw.participation">

  <body>
    <div metal:fill-slot="main">
      <metal:main-macro define-macro="main">

        <h1 i18n:translate="headline_participants" class="documentFirstHeading">
          Participants of
          <tal:title i18n:name="title">
            &laquo;<span tal:replace="here/Title" />&raquo;
          </tal:title>
        </h1>

        <metal:form-macro define-macro="form">
            <p i18n:translate="text_infos_participants">
              General informations about the people who participate on this project. You are also able to remove users from this project.
            </p>


            <form action="" method="post"
                  tal:attributes="action form_action|string:${here/absolute_url}/@@participants">

              <table class="listing">
                <tr>
                  <th>&nbsp;</th>
                  <th i18n:translate="label_user">User</th>
                  <th i18n:translate="label_local_roles">Roles</th>
                  <th i18n:translate="label_invited_by">Invited by</th>
                  <th i18n:translate="label_state">State</th>
                </tr>

                <tal:loop repeat="item view/get_users">

                  <tr tal:define="id_ python:item.get('userid', item.get('iid', None));
                                  type_ item/type_">
                    <td>
                      <input type="checkbox"
                             tal:condition="id_"
                             tal:attributes="name string:${type_}:list;
                                             value id_;
                                             id string:box_${id_};
                                             disabled item/readonly;" />

                    </td>
                    <td tal:content="item/name" />
                    <td tal:content="item/roles" />
                    <td tal:content="python:item.get('inviter', '&nbsp;')" />
                    <td tal:condition="python:item.get('userid', None)" i18n:translate="label_accepted">
                      Accepted
                    </td>
                    <td tal:condition="python: item.get('iid', None)" i18n:translate="label_pending">
                      Pending
                    </td>
                  </tr>

                </tal:loop>
              </table>

              <a tal:attributes="href string:${here/absolute_url}/@@invite_participants"
                 i18n:attributes="title link_invite_participants"
                 i18n:translate="link_invite_participants"
                 class="button">
                Invite participants
              </a>

              <input type="submit" name="form.delete" value="Delete Participants"
                     class="destructive"
                     i18n:attributes="value button_delete_participants" />

              <input type="submit" name="form.cancel" value="Cancel"
                     i18n:attributes="value button_cancel"
                     tal:condition="not:hide_cancel_button|nothing" />

            </form>

        </metal:form-macro>

      </metal:main-macro>
    </div>
  </body>
</html>
